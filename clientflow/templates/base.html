{% load static %}
<html>

  <head>

    <title>Ração do Futuro</title>

    <script src="{% static 'js/jquery-3.5.1.min.js' %}"></script>
    <script src="{% static 'js/jquery-ui.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/extra.js' %}"></script>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.theme.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/extra.css' %}">
  </head>


  <body>
    <div id="content" class="container">
      <nav class="navbar navbar-expand-lg fixed-top popoverbar d-flex">
            <span class="mx-auto header-text">Entrega disponível apenas para a <b>Grande Florianópolis</b></span>
      </nav>
      <nav class="navbar navbar-expand-lg fixed-top topbar">
        <div class="col-10 float-none bg-transparent progress mx-auto">
          <div class="one">          <b class="progress-bar-text">SEU CÃO</b></div>
          <div class="two">          <b class="progress-bar-text">REFEIÇÕES</b></div>
          <div class="three disabled-bar">          <b class="progress-bar-text">PLANOS</b></div>
          <div class="four disabled-bar">          <b class="progress-bar-text">CHECKOUT</b></div>
          <div class="progress-bar icon-bar" style="width: 50%;"></div>
          <div class="progress-bar disabled-bar" style="width: 50%;"></div>
        </div>
      </nav>
      {% block content %}{% endblock %}</p>
      <div class="container mt-3">
        <div class="card">
          <div class="card-body">
              <h5 class="card-title">WebSocket Messages</h5>
              <p class="card-text"><code id="messages"></code></p>
          </div>
        </div>
      </div>
    </div>
    <script>
        var wsprotocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://'
        var ws = wsprotocol + window.location.hostname + ':' + window.location.port + '/ws/'
        var socket = new WebSocket(ws);

        socket.onopen = function() {
          // Web Socket is connected, send some text
          socket.send("Text from Javascript");
          // Send some binary data
          socket.send(new Blob(["Bytes from Javascript"]));
        };

        socket.onmessage = function (evt) {
          console.log(evt)
          var received_msg = evt.data;
          console.log("Message received...", received_msg);
          var node = document.createElement("div");
          if (received_msg instanceof Blob) {
            received_msg.text().then(function (received_text) {
              var textnode = document.createTextNode("> " + received_text);
              node.appendChild(textnode);
              document.getElementById("messages").appendChild(node);
            })
          } else {
            var textnode = document.createTextNode("> " + received_msg);
            node.appendChild(textnode);
            document.getElementById("messages").appendChild(node);
          }
        };
    </script>
  </body>
</html>
