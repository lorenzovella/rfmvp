
{% extends "base_flow.html" %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}
{% block head %}
{{ wizard.form.media }}
<style>
#div_id_CachorroForm3-peso.special:after, #div_id_CachorroForm3-pesoideal.special:after {
  content: "kg";
  position: absolute;
  margin-top: 25px;
  color: #fff;
  left: 50%;
  padding-left: 17px;
}

.ui-datepicker-prev, .ui-datepicker-next{
  display: none;
}
.ui-datepicker-header {
  border: none;
  margin-top: 0.6em;
}
.ui-datepicker-title > select {
  height: 35px;
  margin-left: 5px!important;
}
.ui-datepicker-calendar {
  display: none;
  }
.ui-datepicker{
  height: 72px;
  position: absolute !important;
  top: 112px !important;
  left: 50% !important;
  border:0!important;
  z-index: 10 !important;
  border-radius: 20px;

  -webkit-transform   : translateX(-50%) translateY(-50%) !important;
  -moz-transform      : translateX(-50%) translateY(-50%) !important;
  -ms-transform       : translateX(-50%) translateY(-50%) !important;
  transform           : translateX(-50%) translateY(-50%) !important;
}
</style>
<script>
$(document).ready(function () {
  $('#id_CachorroForm3-peso').one('keydown', function() {
    $('#div_id_CachorroForm3-peso').toggleClass('special');
    $('#id_CachorroForm3-peso').unbind;
  });
  $('#id_CachorroForm3-pesoideal').one('keydown', function() {
    $('#div_id_CachorroForm3-pesoideal').toggleClass('special');
    $('#id_CachorroForm3-pesoideal').unbind;
  });
  $('form').attr('autocomplete','off');
  if($('#id_cachorro_wizard-current_step').val() == "CachorroForm2"){
    // Dog bar animation
    $('.progress-bar.icon-bar').css("width","7%");
    $('.progress-bar.disabled-bar').css("width","93%");

    // Field autocomplete
    var arr = [];
    $.getJSON("/static/racas.json", function(data) {
        $.each(data, function(key, value) {
            if ($.inArray(value.name, arr) === -1) {
                arr.push(value.name)
            }
        })
    });
    $('#id_CachorroForm2-raca').autocomplete({
     source: arr,
     minLength: 2,
    })
  }
  // Dog bar animation
  if($('#id_cachorro_wizard-current_step').val() == "CachorroForm"){
    $('.progress-bar.icon-bar').css("width","0%");
    $('.progress-bar.disabled-bar').css("width","100%");
  }
  if($('#id_cachorro_wizard-current_step').val() == "CachorroForm3"){
    $('.pageMenu .active').toggleClass('changed');
    $("#div_id_CachorroForm3-pesoideal").hide();

    $('.progress-bar.icon-bar').css("width","13%");
    $('.progress-bar.disabled-bar').css("width","87%");

    $('#div_id_CachorroForm3-nascimento .controls').datepicker(
      {
        altField: "#id_CachorroForm3-nascimento",
        dateFormat: "mm/yy",
        yearRange: "-25:+0",
        monthNamesShort: [ "Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez" ],
        changeMonth: true,
        changeYear: true,
        defaultDate: '-1y',
        onChangeMonthYear : function(year, month, inst) {
          $('#id_CachorroForm3-nascimento').val(month+"/"+year);
          var years = moment().diff( moment( $('#id_CachorroForm3-nascimento').val(), "MM-YYYY" ), 'years' );
          if( years < 1 ) {
            $("#div_id_CachorroForm3-pesoideal").show();
            $("#div_id_CachorroForm3-pesoideal input").prop('required',true);
          }
          else {
            $("#div_id_CachorroForm3-pesoideal").hide();
            $("#div_id_CachorroForm3-pesoideal input").prop('required',false);
            $("#div_id_CachorroForm3-pesoideal input").val("0");
          }
        },
        beforeShow : function(input, inst) {
          inst.dpDiv.addClass('month_year_datepicker')
          if ((datestr = $(this).val()).length > 0) {
              year = datestr.substring(datestr.length-4, datestr.length);
              month = datestr.substring(0, 2);
              $(this).datepicker('option', 'defaultDate', new Date(year, month-1, 1));
              $(this).datepicker('setDate', new Date(year, month-1, 1));
              $(".ui-datepicker-calendar").hide();
          }
        }
      })

  }
  if($('#id_cachorro_wizard-current_step').val() == "CachorroForm4"){
    $('.progress-bar.icon-bar').css("width","19%");
    $('.progress-bar.disabled-bar').css("width","81%");
  }
  if($('#id_cachorro_wizard-current_step').val() == "CachorroForm5"){
    $('.progress-bar.icon-bar').css("width","24%");
    $('.progress-bar.disabled-bar').css("width","76%");
  }
  if($('#id_cachorro_wizard-current_step').val() == "Sabores"){
    $('.progress-bar.icon-bar').css("width","33%");
    $('.progress-bar.disabled-bar').css("width","67%");
    $('.two').removeClass('disabled-bar');
  }
})
</script>
{% endblock %}
{% block content %}

<div class='row middle vh-100'>
  <div class='col mx-auto'>
    <form action="" method="post">
      {{ wizard.management_form }}
      {% crispy wizard.form %}
    </form>
  </div>
</div>
{% endblock %}
